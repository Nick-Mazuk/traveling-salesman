!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){var i=e.get(t);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(t):i.value}i.r(e);class o{constructor(t,e){s(this,"cityA",void 0),s(this,"cityB",void 0),h.set(this,{writable:!0,value:"#757575"}),r.set(this,{writable:!0,value:"#FCCE00"}),this.cityA=t,this.cityB=e}draw(t,e,i){if(e){if(t.beginPath(),t.moveTo(this.cityA.anchorX,this.cityA.anchorY),this.cityA.onSameHorizontalRoad(this.cityB))t.lineTo(this.cityB.anchorX,this.cityB.anchorY);else if(this.cityA.blockColumn==this.cityB.blockColumn){if(this.cityA.blockColumnPosition>0&&this.cityB.blockColumnPosition>0){const e=3-this.cityA.blockColumnPosition;t.lineTo(this.cityA.anchorX+e*i,this.cityA.anchorY),t.lineTo(this.cityA.anchorX+e*i,this.cityB.anchorY)}else{const e=this.cityA.blockColumnPosition+1;t.lineTo(this.cityA.anchorX-e*i,this.cityA.anchorY),t.lineTo(this.cityA.anchorX-e*i,this.cityB.anchorY)}t.lineTo(this.cityB.anchorX,this.cityB.anchorY)}else{if(this.cityA.anchorX<this.cityB.anchorX){const e=3-this.cityA.blockColumnPosition;t.lineTo(this.cityA.anchorX+e*i,this.cityA.anchorY),t.lineTo(this.cityA.anchorX+e*i,this.cityB.anchorY)}else{const e=this.cityA.blockColumnPosition+1;t.lineTo(this.cityA.anchorX-e*i,this.cityA.anchorY),t.lineTo(this.cityA.anchorX-e*i,this.cityB.anchorY)}t.lineTo(this.cityB.anchorX,this.cityB.anchorY)}t.strokeStyle=n(this,h),e&&(t.strokeStyle=n(this,r)),t.lineWidth=o.width,t.stroke()}else t.beginPath(),t.moveTo(this.cityA.xPos,this.cityA.yPos),t.lineTo(this.cityB.xPos,this.cityB.yPos),t.strokeStyle=n(this,h),e&&(t.strokeStyle=n(this,r)),t.lineWidth=o.width,t.stroke()}length(t){return this.cityA.distanceFromCity(this.cityB,t)}}var h=new WeakMap,r=new WeakMap;function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}s(o,"width",3);class l{constructor(t=[]){a(this,"cities",void 0),a(this,"roads",void 0),a(this,"totalLength",void 0),this.cities=t.slice(),this.roads=[]}length(t){let e=0;if(0==this.cities.length)return 0;for(let i=0;i<this.cities.length-1;i++)e+=this.cities[i].distanceFromCity(this.cities[i+1],t);return e+=this.cities[0].distanceFromCity(this.cities[this.cities.length-1],t),this.totalLength=e,e}_createRoads(){if(this.roads=[],this.cities.length>2){for(let t=0;t<this.cities.length-1;t++)this.roads.push(new o(this.cities[t],this.cities[t+1]));this.roads.push(new o(this.cities[this.cities.length-1],this.cities[0]))}else this.cities.length>1&&(this.roads.push(new o(this.cities[0],this.cities[1])),this.roads.push(new o(this.cities[1],this.cities[0])));return this.roads}addCity(t){this.cities.push(t)}draw(t,e,i,s,n){t.clearRect(0,0,t.canvas.clientWidth,t.canvas.clientHeight),e.length&&(t.beginPath(),t.rect(0,0,t.canvas.clientWidth,t.canvas.clientHeight),t.fillStyle="#171717",t.fill(),e.forEach(e=>e.draw(t,i,s))),this._createRoads(),this.roads.forEach(e=>e.draw(t,n,i)),this.cities.forEach(e=>e.draw(t,n,Math.min(i,s)))}positionInCity(t,e){return this.cities.filter(i=>i.pointIsInCity(t,e))}randomizeRoute(){this.cities=this.cities.sort(()=>Math.random()-.5)}getRandomCityIndex(t=0,e=this.cities.length){return(Math.ceil(Math.random()*Math.min(this.cities.length-1,e))+t)%this.cities.length}getCityByIndex(t){return this.cities[t]}getLengthChangeFromSwappingCities(t,e,i){if(t==e)return 0;if(t>e){let i=t;t=e,e=i}let s=0,n=this.cities[t],o=this.cities[e],h=this.cities[0==t?this.cities.length-1:t-1],r=this.cities[(e+1)%this.cities.length];return s+=n.distanceFromCity(h,i),s+=o.distanceFromCity(r,i),s-=n.distanceFromCity(r,i),s-=o.distanceFromCity(h,i),s<.001&&s>-.001&&(s=0),s}swapCitiesByIndex(t,e){if(t==e)return;if(t>e){let i=t;t=e,e=i}let i=this.cities.slice();this.cities=[...i.slice(0,t)],this.cities.push(...i.slice(t,e+1).reverse()),this.cities.push(...i.slice(e+1))}removeCity(t){this.cities=this.cities.filter(e=>e.xPos!=t.xPos||e.yPos!=t.yPos)}findNeighbors(t){if(0==this.cities.includes(t))throw new Error("City is not in tour, cannot find neighbors");if(this.cities.length<3)throw new Error("Tour does not have enough cities to find neighbors");let e=[],i=this.cities.indexOf(t);switch(i){case 0:e.push(this.cities[this.cities.length-1]),e.push(this.cities[1]);break;case this.cities.length-1:e.push(this.cities[i-1]),e.push(this.cities[0]);break;default:e.push(this.cities[i-1]),e.push(this.cities[i+1])}return e}cityNeighborsAreClosest(t,e){const i=this.findNeighbors(t),s=Math.max(...i.map(i=>t.distanceFromCity(i,e)));for(let n=0;n<this.cities.length;n++){if(i.includes(this.cities[n])||this.cities[n]==t)continue;if(t.distanceFromCity(this.cities[n],e)<=s)return!1}return!0}clear(){this.cities=[],this.roads=[],this.totalLength=void 0}static getPermutations(t){return(t=>{let e=[];const i=(t,s=[])=>{if(0===t.length)e.push(s);else for(let e=0;e<t.length;e++){let n=t.slice(),o=n.splice(e,1);i(n.slice(),s.concat(o))}};return i(t),e})(t.cities)}}class c{static optimize(t,e,i,s,n){if(t.cities.length<4)return t;switch(n||(t=c.bogo(t)),e){case"annealing":t=c.annealing(t,i,s,!!n);break;case"greedy":t=c.greedy(t,s);break;case"bogo":t=c.bogo(t);break;case"force":t=c.force(t,s);break;case"uncross":t=c.uncross(t,s,!!n);break;case"speedy":t=c.speedy(t,s,n);break;default:t=c.speedy(t,s,n)}return t}static annealing(t,e,i,s,n=150){function o(t,e,i){return i*(1-t/e)+1e-4}s||(t=c.greedy(t,i)),null!=e&&(n=(e.getBoundingClientRect().width+e.getBoundingClientRect().height)/18);let h=s?1.8:2.5,r=100*t.cities.length+(t.cities.length>10?(t.cities.length-10)**h:0),a=0,d=t.length(i),u=new l(t.cities),g=u,m=d;for(;a<r;){let t=o(a,r,n);const e=new l(g.cities),s=e.getRandomCityIndex();let h=e.getRandomCityIndex(s,t);const c=e.getLengthChangeFromSwappingCities(s,h,i),y=Math.random(),f=Math.exp(-Math.abs(c)/t);if(c>0||0!=c&&y<=f){e.swapCitiesByIndex(s,h),g=e;let t=e.length(i);m=t,t<d&&(d=t,u=e)}a++}return u}static greedy(t,e){if(t.cities.length<4)return t;for(let i=0;i<t.cities.length-1;i++){let s=i+1,n=1/0;for(let o=s;o<t.cities.length;o++){let h=t.cities[i].distanceFromCity(t.cities[o],e);h<n&&(s=o,n=h)}t.swapCitiesByIndex(i+1,s)}return t}static bogo(t){return t.randomizeRoute(),t}static force(t,e){if(t.cities.length>9)return alert("Brute force is slow. Very slow. It will likely take minutes if not much longer, so the algorithm was aborted. Please delete cities or choose another algorithm."),t;let i=t.length(e),s=new l(t.cities);return l.getPermutations(t).forEach(t=>{let n=new l(t);const o=n.length(e);o<i&&(i=o,s=n)}),s}static uncross(t,e,i){i||(t=c.greedy(t,e));let s,n=t.length(e);do{s=n;for(let i=0;i<t.cities.length;i++)for(let s=i+1;s<t.cities.length;s++){if(i==s)continue;const o=new l(t.cities);o.getLengthChangeFromSwappingCities(i,s,e)>0&&(o.swapCitiesByIndex(i,s),t=o,n=o.length(e))}}while(t.length(e).toFixed(2)!=s.toFixed(2));return t}static speedyAnnealing(t,e){function i(t,e,i){return i*(1-t/e)+1e-4}const s=3*t.cities.length,n=50*s;let o=0,h=t.length(),r=new l(t.cities),a=r,c=h;for(;o<n;){let t=i(o,n,s);const d=new l(a.cities),u=d.getRandomCityIndex();let g=d.getRandomCityIndex(u,t);const m=d.getLengthChangeFromSwappingCities(u,g,e),y=Math.random(),f=Math.exp(-Math.abs(m)/t);if(m>0||0!=m&&y<=f){d.swapCitiesByIndex(u,g),a=d;let t=d.length(e);c=t,t<h&&(h=t,r=d)}o++}return r}static speedy(t,e,i){if(null!=i){let s=t.cities.indexOf(i),n=!1;for(let i=0;i<t.cities.length;i++){if(i==s)continue;const o=new l(t.cities);if(o.getLengthChangeFromSwappingCities(i,s,e)>0){o.swapCitiesByIndex(i,s),t=o,n=!0;break}}return n?(t=c.speedyAnnealing(t,e),c.uncross(t,e)):t}return t=c.greedy(t,e),t=c.speedyAnnealing(t,e),t=c.uncross(t,e,!0)}}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class u{constructor(t,e,i,s,n,o,h,r,a){d(this,"xPos",void 0),d(this,"yPos",void 0),d(this,"canvas",void 0),g.set(this,{writable:!0,value:"#757575"}),d(this,"selected",!1),d(this,"anchorX",void 0),d(this,"anchorY",void 0),d(this,"blockColumn",void 0),d(this,"blockColumnPosition",void 0),d(this,"blockXSize",void 0),d(this,"blockYSize",void 0),this.canvas=i,this.move(t,e,s,n,o,h,r,a)}draw(t,e,i){if(e){const e=.5*i,s=e/2,n=1.25*e,o=n/2;this.selected&&(t.globalAlpha=.5),t.drawImage(u.houseImage,this.xPos-o,this.yPos-s,n,e),this.selected&&(t.globalAlpha=1)}else t.beginPath(),t.arc(this.xPos,this.yPos,u.radius,0,2*Math.PI),t.fillStyle=function(t,e){var i=e.get(t);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(t):i.value}(this,g),t.fill()}pointIsInCity(t,e){return this.distanceFromPoint(t,e)<u.radius}distanceFromPoint(t,e){return Math.sqrt((t-this.xPos)**2+(e-this.yPos)**2)}distanceFromCity(t,e){if(e){let e=Math.abs(this.anchorX-t.anchorX)+Math.abs(this.anchorY-t.anchorY);const i=this.blockColumn==t.blockColumn,s=this.onSameHorizontalRoad(t);return i&&!s&&(1==this.blockColumnPosition&&1==t.blockColumnPosition?e+=4*this.blockXSize:e+=2*this.blockXSize),e}return Math.sqrt((t.xPos-this.xPos)**2+(t.yPos-this.yPos)**2)}move(t,e,i,s,n,o,h,r){t<u.radius&&(t=u.radius),e<u.radius&&(e=u.radius),t>this.canvas.getBoundingClientRect().width-u.radius&&(t=this.canvas.getBoundingClientRect().width-u.radius),e>this.canvas.getBoundingClientRect().height-u.radius&&(e=this.canvas.getBoundingClientRect().height-u.radius),this.xPos=t,this.yPos=e,i&&(this.anchorX=i),s&&(this.anchorY=s),null!=n&&(this.blockColumn=n),null!=o&&(this.blockColumnPosition=o),h&&(this.blockXSize=h),r&&(this.blockYSize=r)}onSameHorizontalRoad(t){return Math.abs(this.anchorY-t.anchorY)<3}static isPointInBlock(t,e,i){const s=e.getImageData(t[0]*i,(t[1]+o.width)*i,1,1).data;if(23==s[0]&&23==s[1]&&23==s[2])return!1;const n=e.getImageData(t[0]*i,(t[1]-o.width)*i,1,1).data;if(23==n[0]&&23==n[1]&&23==n[2])return!1;const h=e.getImageData((t[0]-o.width)*i,t[1]*i,1,1).data;if(23==h[0]&&23==h[1]&&23==h[2])return!1;const r=e.getImageData((t[0]+o.width)*i,t[1]*i,1,1).data;return 23!=r[0]||23!=r[1]||23!=r[2]}}var g=new WeakMap;function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}d(u,"radius",10),d(u,"houseImage",new Image);class y{constructor(t,e,i,s){m(this,"xPos",void 0),m(this,"yPos",void 0),m(this,"width",void 0),m(this,"height",void 0),f.set(this,{writable:!0,value:"#007A00"}),this.xPos=t,this.yPos=e,this.width=i,this.height=s}draw(t,e,i){let s=e/4;t.beginPath(),t.moveTo(this.xPos*e+s,this.yPos*i),t.lineTo((this.xPos+this.width)*e-s,this.yPos*i),t.quadraticCurveTo((this.xPos+this.width)*e,this.yPos*i,(this.xPos+this.width)*e,this.yPos*i+s),t.lineTo((this.xPos+this.width)*e,(this.yPos+this.height)*i-s),t.quadraticCurveTo((this.xPos+this.width)*e,(this.yPos+this.height)*i,(this.xPos+this.width)*e-s,(this.yPos+this.height)*i),t.lineTo(this.xPos*e+s,(this.yPos+this.height)*i),t.quadraticCurveTo(this.xPos*e,(this.yPos+this.height)*i,this.xPos*e,(this.yPos+this.height)*i-s),t.lineTo(this.xPos*e,this.yPos*i+s),t.quadraticCurveTo(this.xPos*e,this.yPos*i,this.xPos*e+s,this.yPos*i),t.fillStyle=function(t,e){var i=e.get(t);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(t):i.value}(this,f),t.fill()}}var f=new WeakMap;function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class b{constructor(){p(this,"modalElement",void 0),p(this,"closeButton",void 0),p(this,"skipButton",void 0),p(this,"previousButton",void 0),p(this,"nextButton",void 0),p(this,"finishButton",void 0),p(this,"replayTutorialElement",void 0),p(this,"bodyContent",void 0),p(this,"contentImage",void 0),p(this,"currentPanel",0),p(this,"panels",["<h2>What is the traveling salesman problem?</h2>\n        <p>How can Amazon deliver toilet paper in 2 days? This isn't a simple problem. At the very last stretch, Amazon loads your toilet paper into a van. But that van has dozens of other deliveries. So Amazon needs to <b>find the shortest route between every house</b>. Finding that shortest route is the traveling salesman problem.</p>","<h2>Add, move, or remove houses…</h2>\n        <ul>\n            <li><b>Add houses</b>: Click somewhere empty to add a house</li>\n            <li><b>Move houses</b>: Click and drag to move it around</li>\n            <li><b>Remove houses</b>: Just click a house and it's gone</li>\n        </ul>","<h2>…and the route updates in real-time!</h2>\n        <p>Unlike most traveling salesman visualizers, this one updates in real-time. Explore how <b>minor movements can cause massive changes</b>.</p>","<h2>Choose your algorithm wisely…</h2>\n        <p>Select an algorithm from the dropdown menu.</p>\n        <ul>\n            <li><b>Brute Force</b>: Checks every possible path, guarantees shortest path</li>\n            <li><b>Greedy</b>: Each house connects with the next closest house</li>\n            <li><b>Annealing</b>: Gradually improves through random changes, avoids local mins</li>\n            <li><b>2-opt</b>: Chooses random path, then uncrosses intersections</li>\n            <li><b>Speedy</b>: Custom algorithm, combines greedy, annealing, and uncrossing</li>\n            <li><b>BOGO</b>: Chooses random path, odds of finding shortest path is 1:(n - 1)!</li>\n        </ul>","<h2>…because some are just better than others.</h2>\n        <p>Some take way too long to finish. Others find paths that are way too long. Choose wisely or you'll have to wait until the heat death of the universe for an answer.</p>","<h2>Choose your own reality.</h2>\n        <p>Find the shortest route through some bustling suburbs, or test the limits of the algorithms on a lifeless, theoretical void. The choice is yours!</p>","<h2>Explore this simulation in depth</h2>\n        <p>Learn the specifics behind each algorithm.</p>\n        <p>Check out the code on <a href='https://github.com/Nick-Mazuk/traveling-salesman' target='_blank'>Github</a> (and star the repo).</p>","<h2>Now go conquer the world!!</h2>"]),p(this,"panelImages",["./assets/logo/logo.svg","./assets/addHouses.gif","./assets/updateRealTime.gif","./assets/chooseAlgorithm.gif","./assets/algorithmComparison.gif","./assets/cityGrid.gif","./assets/more.gif","./assets/logo/logo.svg"]),this.getHTMLElements(),this.addEventListeners(),this.displayPanel()}getHTMLElements(){this.modalElement=document.querySelector("#tutorial-modal"),this.closeButton=document.querySelector("#tutorial-close"),this.skipButton=document.querySelector("#tutorial-skip"),this.previousButton=document.querySelector("#tutorial-previous"),this.nextButton=document.querySelector("#tutorial-next"),this.finishButton=document.querySelector("#tutorial-finish"),this.bodyContent=document.querySelector("#tutorial-content"),this.contentImage=document.querySelector("#tutorial-image"),this.replayTutorialElement=document.querySelector("#tutorial-replay")}addEventListeners(){this.closeButton.addEventListener("click",()=>this.closeModal()),this.skipButton.addEventListener("click",()=>this.closeModal()),this.previousButton.addEventListener("click",()=>this.previousPanel()),this.nextButton.addEventListener("click",()=>this.nextPanel()),this.finishButton.addEventListener("click",()=>this.closeModal()),this.replayTutorialElement.addEventListener("click",()=>this.replayTutorial())}openModal(){this.modalElement.classList.add("is-active")}closeModal(){this.modalElement.classList.remove("is-active")}ifLastPanel(){this.currentPanel==this.panels.length-1?(this.nextButton.classList.add("is-hidden"),this.finishButton.classList.remove("is-hidden")):(this.nextButton.classList.remove("is-hidden"),this.finishButton.classList.add("is-hidden"))}ifFirstPanel(){0==this.currentPanel?this.previousButton.classList.add("is-hidden"):this.previousButton.classList.remove("is-hidden")}updateButtons(){this.ifFirstPanel(),this.ifLastPanel()}nextPanel(){this.currentPanel++,this.displayPanel()}previousPanel(){this.currentPanel--,this.displayPanel()}preloadImage(){this.panelImages[this.currentPanel+1]&&(this.bodyContent.innerHTML+=`<link rel="preload" href="${this.panelImages[this.currentPanel+1]}" as="image">`)}displayPanel(){this.bodyContent.innerHTML=this.panels[this.currentPanel],this.contentImage.src=this.panelImages[this.currentPanel],this.updateButtons(),this.preloadImage()}replayTutorial(){this.currentPanel=0,this.displayPanel(),this.openModal()}}let v,w;const P=window.devicePixelRatio||1;let C,B,k,x,M,A,I,E,S,L,T,R=new l,F=[];let X,q=20,Y={force:"<b>Brute Force Algorithm</b>: Checks every possible path, guarantees shortest path",greedy:"<b>Greedy Algorithm</b>: Each node goes to the next closest node, finds suboptimal path excluding trivial cases",hillClimber:"<b>Hill Climber Algorithm</b>: Compares tiny changes to current path, chooses better one",annealing:"<b>Annealing Algorithm</b>: Gradually improves through random changes but avoids local minimums",genetic:"<b>Genetic Algorithm</b>: Simulates all of human life",uncross:"<b>2-Opt Algorithm</b>: Chooses random path, then uncrosses intersections",speedy:"<b>Speedy Algorithm</b>: A custom algorithm that combines greedy, annealing, and uncrossing algorithms",bogo:"<b>Bogo-Style Algorithm</b>: Chooses random path, odds of finding shortest path is 1:(n - 1)!"};function z(t=!1){let e=performance.now();R=t?c.optimize(R,x,v,I,C):c.optimize(R,x,v,I);let i=performance.now();M.innerHTML=(i-e).toFixed(3),R.draw(w,F,L,T,I),A.innerHTML=""+R.length(I).toFixed(0)}function O(t){return[t.clientX-v.getBoundingClientRect().left,t.clientY-v.getBoundingClientRect().top]}function H(t){if(!(3==t.which||2==t.button)){if(1==I){if(B=_(O(t)),0==u.isPointInBlock(B,w,P))return}else B=O(t);let i=(null==e&&(e=B),R.positionInCity(e[0],e[1]));i.length?(C=i[0],C.selected=!0,I&&R.draw(w,F,L,T,I)):function(t){let e,i,s;if(I){e=B[0],i=B[1];let t=e,n=i-T;u.isPointInBlock([e,i-T],w,P)&&(n=i+T);let o=Math.round((e-L/2)/L);const h=o-1-Math.floor(o/4),r=Math.floor(o/4);s=new u(e,i,v,t,n,r,h%3,L)}else e=t.clientX-v.getBoundingClientRect().left-u.radius/2,i=t.clientY-v.getBoundingClientRect().top-u.radius/2,s=new u(e,i,v);R.addCity(s),z()}(t)}var e;k=!0}function j(t){C&&k&&(R.removeCity(C),z()),k=void 0,C&&(C.selected=!1),C=void 0,I&&(X.classList.add("is-hidden"),R.draw(w,F,L,T,I))}function W(t){if(C)if(I){let e=_(O(t));if((e[0]!=C.xPos||e[1]!=C.yPos)&&u.isPointInBlock(e,w,P)&&0==R.positionInCity(e[0],e[1]).length){let t=e[0],i=e[1]-T;u.isPointInBlock([e[0],e[1]-T],w,P)&&(i=e[1]+T);let s=Math.round((e[0]-L/2)/L);const n=s-1-Math.floor(s/4),o=Math.floor(s/4),h=n%3;C.move(e[0],e[1],t,i,o,h,L),z(!0)}!function(t){X.classList.remove("is-hidden"),X.style.transform=`translate(calc(${t.clientX}px - 50%), calc(${t.clientY}px - 200%)) rotate(-30deg)`}(t)}else{let e=O(t);C.move(e[0],e[1]),z(!0)}k=!1}function _(t){return function(t){let e=Math.floor(t[0]*L+L/2),i=Math.floor(t[1]*T+T/2);return[e,i]}(function(t){let e=Math.floor(t[0]/L),i=Math.floor(t[1]/T);return[e,i]}(t))}function G(t,e){let i=window.innerWidth,s=window.innerHeight;s-=document.querySelector("#top-navbar").getBoundingClientRect().height,s-=document.querySelector("#bottom-navbar").getBoundingClientRect().height,i*=P,s*=P,function(t,e,i,s){if(R.cities.length){const n=i/t,o=s/e;R.cities.forEach(t=>{t.canvas=v,t.move(Math.round(t.xPos*n),Math.round(t.yPos*o))})}}(t.width,t.height,i,s),t.width=i,t.height=s,w=t.getContext("2d"),w.scale(P,P),0!=e&&z()}function D(){x=document.getElementById("algorithm-mode").value,R.randomizeRoute(),z(),document.querySelector("#algorithm-descriptions").innerHTML=Y[x]}function N(t){const e=v.getBoundingClientRect().width,i=v.getBoundingClientRect().height,s=u.radius;if(R.clear(),R.draw(w,F,L,T,I),I){const e=3*S,i=2*E,s=[],n=Math.min(t,e*i);for(;s.length<n;){const t=Math.floor(Math.random()*e),n=Math.floor(Math.random()*i);0==s.filter(e=>e[0]==t&&e[1]==n).length&&s.push([t,n])}s.forEach(t=>{const e=(t[0]+Math.floor(t[0]/3)+1)*L+L/2,i=(t[1]+Math.floor(t[1]/2)+1)*T+T/2;let s=e,n=i-T;u.isPointInBlock([e,i-T],w,P)&&(n=i+T);const o=Math.floor(t[0]/3),h=t[0]%3,r=new u(e,i,v,s,n,o,h,L,T);R.addCity(r)})}else for(let n=0;n<t;n++){const t=new u(Math.floor(Math.random()*(e-2*s))+s,Math.floor(Math.random()*(i-2*s))+s,v);R.addCity(t)}D()}function $(){I?function(){const t=v.getBoundingClientRect().width,e=v.getBoundingClientRect().height;S=Math.floor(t/200),L=t/(4*S+1),E=Math.round(e/(3*L+1)),T=e/(3*E+1);for(let t=0;t<S;t++){let e=4*t+1;for(let t=0;t<E;t++){let i=3*t+1;F.push(new y(e,i,3,2))}}}():F=[]}function J(){R.clear(),z()}function U(t){I=t.currentTarget.checked,q=I?20:200,$(),N(q)}function V(t){z(!1)}window.addEventListener("DOMContentLoaded",(function(){var t;v=document.querySelector("canvas"),M=document.querySelector("#timing"),A=document.querySelector("#length"),X=document.querySelector("#hoveredHouse"),G(t=v,!1),t.addEventListener("mousedown",H),t.addEventListener("mouseup",j),t.addEventListener("mousemove",W),I=document.getElementById("mode").checked,u.houseImage.src="./assets/house.svg",document.getElementById("algorithm-mode").addEventListener("change",D),document.getElementById("clear-board").addEventListener("click",J),document.getElementById("random-board").addEventListener("click",()=>N(q)),document.getElementById("mode").addEventListener("change",U),window.addEventListener("resize",()=>G(v)),document.getElementById("recalculate-button").addEventListener("click",V),$(),N(q),new b}))}]);